setwd("C:\\MicroArrayAnalysis")
list.files()
?read.csv
microarray <- read.csv("Assignments04_Data\GSE7765-GPL96-series-matrix.txt",
microarray <- read.csv("Assignments04_Data\\GSE7765-GPL96-series-matrix.txt",
skip = 66, # skip first 66 lines
sep = "\t",
row.names = 1,
header = TRUE
)
View(microarray)
dim(microarray)
View(microarray)
boxplot(microarray)
boxplot(microarray, las = 2, cex.axis = 0.7)
boxplot(microarray, las = 2, cex.axis = 0.5)
boxplot(microarray, las = 1.6, cex.axis = 0.7)
boxplot(microarray, las = 2, cex.axis = 0.7)
boxplot(microarray, las = 3, cex.axis = 0.7)
class(microarray)
res1 <- apply(microarray, 1, log2)
res2 <- apply(microarray, 2, log2)
identical(res1, res2)
all.equal(res1, res2)
hist(microarray[,1])
hist(microarray[,1], breaks = 100)
raw.data <- read.csv(file = "Assignments04_Data/GSE7765-GPL96-series-matrix.txt",
sep = "\t",
header = TRUE,
row.names = 1,
skip = 66) # skip first 66 lines
dim(raw.data)
hist(raw.data[,1], breaks = 100)
log.data <- apply(raw.data, 2, log2)
dim(log.data)
boxplot(log.data, las = 2, cex.axis = 0.7)
head(raw.data,2)
head(log.data,2)
log2(15630.2)
hist(log.data[,1], breaks = 100)
boxplot(log.data, las = 2, cex.axis = 0.7)
BiocManager::install("preprocessCore")
library(preprocessCore)
log.norm.data <- normalize.quantiles(log.data)
boxplot(log.norm.data, las = 2, cex.axis = 0.7)
head(log.data)
head(log.norm.data)
rownames(log.norm.data) <- rownames(log.data)
colnames(log.norm.data) <- colnames(log.data)
boxplot(log.norm.data, las = 2, cex.axis = 0.7)
# How different samples are to each other
#
# dist() works on rows
clusters <- hclust(dist(t(log.norm.data)))
plot(clusters)
scaled.variation <- apply(log.norm.data, 1, function(x){
var(x)/mean(x)})
dim(scaled.variation)
length(scaled.variation)
class(scaled.variation)
scaled.variation
which(scaled.variation > 1)
hvg <- names(which(scaled.variation > 1))
hvg
library(GEOquery)
gse <- getGEO('GSE7765')
annotation(gse)
annotation(gse[[1]])
gse
BiocManager::available(pattern="GPL97")
gpl <- getGEO("GPL97")
head(Table(gpl))
library(org.Hs.eg.db)
library(AnnotationDbi)
gpl_table <- Table(gpl)
View(gpl_table)
gpl_table <- gpl_table[, c("ID", "GB_ACC")]
View(gpl_table)
gene_symbols <- mapIds(org.Hs.eg.db,
keys = gpl_table$GB_ACC,
column = "SYMBOL",
keytype = "REFSEQ",
multiVals = "first")
gpl.table <- Table(gpl)
gpl.table <- gpl.table[, c("ID", "GB_ACC")]
gpl.table$GeneSymbol <- mapIds(org.Hs.eg.db,
keys = gpl_table$GB_ACC,
column = "SYMBOL",
keytype = "REFSEQ",
multiVals = "first")
View(gpl.table)
class(hvg)
hvp <- names(which(scaled.variation > 1))
hvp
gpl.table$ID %in% hvp
# highly variable genes
hvg <- gpl.table$GeneSymbol[gpl.table$ID %in% hvp]
hvg
hvp
head(gpl.table$GB_ACC)
head(hvp)
head(gpl.table$ID)
head(gpl.table$GeneSymbol)
gse <- getGEO('GSE7765')[[1]] # from 2nd line of data file !Series_geo_accession	"GSE7765"
gse
gpl <- getGEO("GPL96")
head(Table(gpl))
gpl.table <- Table(gpl)
gpl.table <- gpl.table[, c("ID", "GB_ACC")]
gpl.table$GeneSymbol <- mapIds(org.Hs.eg.db,
keys = gpl_table$GB_ACC,
column = "SYMBOL",
keytype = "REFSEQ",
multiVals = "first")
gpl.table$GeneSymbol <- mapIds(org.Hs.eg.db,
keys = gpl.table$GB_ACC,
column = "SYMBOL",
keytype = "REFSEQ",
multiVals = "first")
# highly variable genes
hvg <- gpl.table$GeneSymbol[gpl.table$ID %in% hvp]
length(hvp)
length(hvg)
hvg
View(hvg)
# look at last line Annotation: GPL96  or
annotation(gse)
class(gpl.table)
names(hvg)
values(hvg)
value(hvg)
# highly variable genes
hvg <- gpl.table[gpl.table$ID %in% hvp, "GeneSymbol"]
hvg
View(hvg)
# highly variable genes
hvg <- gpl.table[gpl.table$ID %in% hvp, gpl.table$GeneSymbol]
gpl.table$GeneSymbol[gpl.table$ID %in% hvp]
# highly variable genes
hvg <- gpl.table$GeneSymbol[gpl.table$ID %in% hvp]
class(hvg)
hvg <- unlist(hvg)
hvg
as.character(hvg)
plot(scaled.variation)
heatmap(log.norm.data[hvp,])
heatmap(log.norm.data[hvp,], cexRow = 0.7, cexCol=0.7)
as.character(hvg)
# Transpose so samples are rows (needed for PCA)
pca <- prcomp(t(log.norm.data), scale. = TRUE)
t(log.norm.data)
test <- t(log.norm.data)
View(test)
test <- log.norm.data[apply(log.norm.data, 1, var) == 0, ]
# Remove rows (probes) with zero variance
log.norm.data.filtered <- log.norm.data[apply(log.norm.data, 1, var) != 0, ]
# Transpose so samples are rows (needed for PCA)
pca <- prcomp(t(log.norm.data.filtered), scale. = TRUE)
plot(pca$x[,1], pca$x[,2],
xlab = "PC1",
ylab = "PC2",
main = "PCA of samples",
pch = 19)
View(log.norm.data.filtered)
legend("bottomleft", legend = unique(colnames(log.norm.data.filtered)),
col = 1:length(unique(colnames(log.norm.data.filtered))), pch = 19)
plot(pca$x[,1], pca$x[,2],
xlab = "PC1",
ylab = "PC2",
main = "PCA of samples",
pch = colnames(log.norm.data.filtered))
plot(pca$x[,1], pca$x[,2],
xlab = "PC1",
ylab = "PC2",
main = "PCA of samples",
type = 'n')
text(pca$x[,1], pca$x[,2],
labels = colnames(log.norm.data.filtered),
cex = 0.8)
text(pca$x[,1], pca$x[,2],
labels = colnames(log.norm.data.filtered),
cex = 0.7)
plot(pca$x[,1], pca$x[,2],
xlab = "PC1",
ylab = "PC2",
main = "PCA of samples",
type = 'n')
text(pca$x[,1], pca$x[,2],
labels = colnames(log.norm.data.filtered),
cex = 0.6)
columns(org.Hs.eg.db)
head(org.Hs.eg.db, 5)
head(org.Hs.eg.db)
gpl.table$GeneSymbol <- mapIds(org.Hs.eg.db,
keys = gpl.table$GB_ACC,
column = "SYMBOL",
keytype = "ACCNUM",
multiVals = "first")
View(gpl.table)
# highly variable genes
hvg <- gpl.table$GeneSymbol[gpl.table$ID %in% hvp]
as.character(hvg)
head(gpl.table$GB_ACC)
View(gpl.table)
gpl.table$GB_ACC
gb_acc_sample <- gpl.table$GB_ACC[1:5]
gb_acc_sample %in% keys(org.Hs.eg.db, keytype="REFSEQ")
gb_acc_sample %in% keys(org.Hs.eg.db, keytype="ACCNUM")
columns(org.Hs.eg.db)
library(hgu133a.db)
BiocManager::install("hgu133a.db")
library(hgu133a.db)
# map your highly variable probes (hvp) to gene symbols
hvg <- mapIds(hgu133a.db,
keys = hvp,
column = "SYMBOL",
keytype = "PROBEID",
multiVals = "first")
hvg
as.character(hvg)
keys(hgu133a.db)
columns(hgu133a.db)
platform <- annotation(gse)
platform
